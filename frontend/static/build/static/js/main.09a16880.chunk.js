(this.webpackJsonpstatic=this.webpackJsonpstatic||[]).push([[0],{18:function(t,e,n){},20:function(t,e,n){},22:function(t,e,n){"use strict";n.r(e);var a=n(4),s=n.n(a),r=n(13),o=n.n(r),i=(n(18),n(2)),c=n.n(i),h=n(11),u=n(9),l=n(5),d=n(6),p=n(3),j=n(8),b=n(7),m=(n(20),n(10)),g=n(1),O=n.n(g),f=n(0),v=function(t){Object(j.a)(n,t);var e=Object(b.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).state={username:"",email:"",password:""},a.handleInput=a.handleInput.bind(Object(p.a)(a)),a.handleLogin=a.handleLogin.bind(Object(p.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this;if(this.state.isLoggedIn){var e={headers:{"Content-Type":"Application/Json","X-CSRFToken":O.a.get("csrftoken"),Authorization:O.a.get("Authorization")}};console.log(e),fetch("/api/v1/chat",e).then((function(t){return t.json()})).then((function(e){return t.setState({chat:Object(h.a)(e)})})),console.log("Logged in.")}else console.log("Logged out.")}},{key:"handleInput",value:function(t){this.setState(Object(m.a)({},t.target.name,t.target.value))}},{key:"handleLogin",value:function(){var t=Object(u.a)(c.a.mark((function t(e,n){var a,s,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),a={method:"POST",headers:{"Content-Type":"Application/JSON","X-CSRFToken":O.a.get("csrftoken")},body:JSON.stringify({username:n.username,email:n.email,password:n.password})},t.next=4,fetch("/rest-auth/login/",a);case 4:return s=t.sent,t.next=7,s.json().catch((function(t){return console.log(t)}));case 7:r=t.sent,console.log(r),r.key?(O.a.set("Authorization","Token ".concat(r.key)),this.setState({isLoggedIn:!!O.a.get("Authorization")})):alert("Did not log in.");case 10:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h2",{children:"Login"}),Object(f.jsxs)("form",{className:"d-flex flex-column",onSubmit:function(e){return t.handleLogin(e,t.state)},children:[Object(f.jsxs)("div",{className:"input-group",children:[Object(f.jsx)("label",{htmlFor:"username",children:"Username"}),Object(f.jsx)("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInput})]}),Object(f.jsxs)("div",{className:"input-group",children:[Object(f.jsx)("label",{htmlFor:"email",children:"Email"}),Object(f.jsx)("input",{type:"email",name:"email",value:this.state.email,onChange:this.handleInput})]}),Object(f.jsxs)("div",{className:"input-group",children:[Object(f.jsx)("label",{htmlFor:"password",children:"Password"}),Object(f.jsx)("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleInput})]}),Object(f.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Login"})]}),Object(f.jsxs)("p",{children:["Don't have an account? Why not ",Object(f.jsx)("a",{onClick:function(){return t.props.loginOrRegister()},href:"#",children:"Register"}),"first?"]})]})}}]),n}(a.Component),x=function(t){Object(j.a)(n,t);var e=Object(b.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).state={username:"",email:"",password1:"",password2:""},a.handleRegistration=a.handleRegistration.bind(Object(p.a)(a)),a.handleInput=a.handleInput.bind(Object(p.a)(a)),a}return Object(d.a)(n,[{key:"handleRegistration",value:function(){var t=Object(u.a)(c.a.mark((function t(e,n){var a,s,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":O.a.get("csrftoken")},body:JSON.stringify({username:n.username,email:n.email,password1:n.password1,password2:n.password2})},t.next=3,fetch("/rest-auth/registration/",a);case 3:return s=t.sent,t.next=6,s.json();case 6:r=t.sent,console.log("Registration data: "+r),r.key&&O.a.set("Authorization","Token ".concat(r.key)),this.setState({isLoggedIn:!!O.a.get("Authorization")}),e.preventDefault();case 11:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"handleInput",value:function(t){this.setState(Object(m.a)({},t.target.name,t.target.value))}},{key:"render",value:function(){var t=this;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h2",{children:"Register"}),Object(f.jsxs)("form",{action:"",onSubmit:function(e){return t.handleRegistration(e,t.state)},children:[Object(f.jsx)("label",{htmlFor:"username",children:"Username"}),Object(f.jsx)("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleInput}),Object(f.jsx)("label",{htmlFor:"email",children:"Email"}),Object(f.jsx)("input",{type:"email",name:"email",value:this.state.email,onChange:this.handleInput}),Object(f.jsx)("label",{htmlFor:"password1",children:"Password"}),Object(f.jsx)("input",{type:"password",name:"password1",value:this.state.password1,onChange:this.handleInput}),Object(f.jsx)("label",{htmlFor:"password2",children:"Confirm Password"}),Object(f.jsx)("input",{type:"password",name:"password2",value:this.props.password2,onChange:this.props.handleInput}),Object(f.jsx)("button",{className:"btn btn-success",type:"submit",children:"Register"}),Object(f.jsxs)("p",{children:["Already have an account? Why not ",Object(f.jsx)("a",{onClick:function(){return t.props.loginOrRegister()},href:"#",children:"Login"}),"?"]})]})]})}}]),n}(a.Component),y=function(t){Object(j.a)(n,t);var e=Object(b.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).state={rooms:[]},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=Object(u.a)(c.a.mark((function t(){var e,n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/v1/chat/rooms");case 2:return e=t.sent,t.next=5,e.json();case 5:(n=t.sent).detail||this.setState({rooms:n});case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t,e=this,n=null===(t=this.state.rooms)||void 0===t?void 0:t.map((function(t){return Object(f.jsx)("section",{children:Object(f.jsx)("button",{className:"btn btn-info mb-3",onClick:function(){return e.props.handleRoomSwitch(t)},children:t.title})},t.id)}));return Object(f.jsx)(f.Fragment,{children:n})}}]),n}(a.Component),k=function(t){Object(j.a)(n,t);var e=Object(b.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).state={user:"",name:"",text:"",room:2,current_room:2},a.handleInput=a.handleInput.bind(Object(p.a)(a)),a.handlePost=a.handlePost.bind(Object(p.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=Object(u.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"handlePost",value:function(){var t=Object(u.a)(c.a.mark((function t(e,n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this.setState({name:this.props.user,title:this.state.title,text:this.state.text,room:this.props.current_room}),console.log("From Post: "+n),t.next=5,fetch("/api/v1/chat/",{method:"POST",headers:{"Content-Type":"Application/JSON","X-CSRFToken":O.a.get("csrftoken"),Authorization:O.a.get("Authorization")},body:JSON.stringify({name:this.props.user,title:this.state.title,text:this.state.text,room:this.state.current_room})});case 5:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"handleInput",value:function(t){this.setState(Object(m.a)({},t.target.name,t.target.value))}},{key:"render",value:function(){var t,e=this;return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("form",{action:"",onSubmit:function(t){return e.handlePost(t)},children:[Object(f.jsx)("p",{children:this.props.user}),Object(f.jsxs)("div",{className:"input-group",children:[Object(f.jsx)("label",{htmlFor:"text",children:"Share your thoughts!"}),Object(f.jsx)("input",{type:"text",value:null===(t=this.state.chat)||void 0===t?void 0:t.text,name:"text",onChange:this.handleInput})]}),Object(f.jsx)("button",{className:"btn btn-success",type:"submit",children:"Chat!"})]})})}}]),n}(a.Component),w=function(t){Object(j.a)(n,t);var e=Object(b.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).handleDelete=a.handleDelete.bind(Object(p.a)(a)),a}return Object(d.a)(n,[{key:"handleDelete",value:function(t){fetch("api/v1/chat/"+t.id+"/delete/",{method:"DELETE",headers:{"Application-Type":"Application/Json",Authorization:O.a.get("Authorization")}}),this.setState({name:t.name,title:t.title,text:t.text})}},{key:"render",value:function(){var t,e=this,n=null===(t=this.props.chat)||void 0===t?void 0:t.map((function(t){return Object(f.jsx)("section",{onClick:function(){t.name===e.props.user&&console.log(t)},children:t.room===e.props.current_room?Object(f.jsxs)("div",{className:"card",children:[Object(f.jsx)("p",{children:t.name}),Object(f.jsxs)("div",{className:"card-body",children:[Object(f.jsx)("p",{children:t.text}),Object(f.jsx)("button",{className:"btn btn-primary",onClick:function(n){return e.props.handleEdit(t,n)},children:"Edit"}),Object(f.jsx)("button",{style:{"margin-left":"5px"},className:"btn btn-danger",onClick:function(){return e.handleDelete(t.id,e.state)},children:"Delete"})]})]}):null},t.id)}));return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)("div",{className:"chat-display",children:n})})}}]),n}(a.Component),S=function(t){Object(j.a)(n,t);var e=Object(b.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).state={loginOrRegister:!0,rooms:[]},a.handleLoginOrRegister=a.handleLoginOrRegister.bind(Object(p.a)(a)),a}return Object(d.a)(n,[{key:"handleLoginOrRegister",value:function(){this.setState((function(t){return{loginOrRegister:!t.loginOrRegister}}))}},{key:"handleLogout",value:function(){var t=Object(u.a)(c.a.mark((function t(e){var n,a,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"POST",headers:{"Content-Type":"Application/JSON","X-CSRFToken":O.a.get("csrftoken")}},t.next=3,fetch("/rest-auth/logout/",n);case 3:return a=t.sent,t.next=6,a.json().catch((function(t){return console.log(t)}));case 6:s=t.sent,O.a.remove("Authorization"),this.setState({isLoggedIn:!!O.a.get("Authorization")}),console.log(s);case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(f.jsx)(f.Fragment,{children:this.props.isLoggedIn?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(k,{current_room:this.props.current_room,room:this.props.room,user:this.props.user,isEditMode:this.props.isEditMode,handleInput:this.props.handleInput,handlePost:this.props.handlePost}),Object(f.jsx)(w,{current_room:this.props.current_room,room:this.state.rooms,user:this.props.user,chat:this.props.chat,isEditMode:this.props.isEditMode,handleEditMode:this.props.handleEditMode,handleEdit:this.props.handleEdit,handleDelete:this.props.handleDelete}),Object(f.jsx)("button",{className:"btn btn-danger",onClick:function(){return t.handleLogout(t.props.user)},children:"Logout"})]}):Object(f.jsx)(f.Fragment,{children:this.state.loginOrRegister?Object(f.jsx)(v,{user:this.props.user,loginOrRegister:this.handleLoginOrRegister,handleLogin:this.props.handleLogin,isLoggedIn:this.props.isLoggedIn,handleInput:this.props.handleInput}):Object(f.jsx)(x,{user:this.props.user,loginOrRegister:this.handleLoginOrRegister,isLoggedIn:this.props.isLoggedIn,handleRegistration:this.props.handleRegistration,handleInput:this.props.handleInput})})})}}]),n}(a.Component),C=function(t){Object(j.a)(n,t);var e=Object(b.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).state={chat:[],isLoggedIn:!!O.a.get("Authorization"),isEditMode:!1,password:"",id:0,user:"",room:2,current_room:2},a.handleEditMode=a.handleEditMode.bind(Object(p.a)(a)),a.handleEdit=a.handleEdit.bind(Object(p.a)(a)),a.handleRoomSwitch=a.handleRoomSwitch.bind(Object(p.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=Object(u.a)(c.a.mark((function t(){var e,n,a,s=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/rest-auth/user/");case 2:return e=t.sent,t.next=5,e.json();case 5:n=t.sent,this.setState({user:n.username}),console.log(this.state.user),this.state.isLoggedIn?(a={headers:{"Content-Type":"Application/Json","X-CSRFToken":O.a.get("csrftoken"),Authorization:O.a.get("Authorization")}},fetch("/api/v1/chat",a).then((function(t){return t.json()})).then((function(t){t.length>0&&s.setState({chat:Object(h.a)(t)})})),console.log("Logged in.")):console.log("Logged out.");case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handleEditMode",value:function(){this.setState((function(t){return{isEditMode:!t}}))}},{key:"handleRoomSwitch",value:function(t){this.setState({current_room:t.id})}},{key:"handleEdit",value:function(t){this.props.handleEditMode(),fetch("/api/v1/chat/"+t.id+"/update/",{method:"PUT",headers:{"Content-Type":"Application/Json",Authorization:O.a.get("Authorization"),"X-CSRFToken":O.a.get("csrftoken")},body:JSON.stringify({id:t.id,name:t.name,text:t.text,owner:t.owner,room:t.room})}),this.setState({name:t.name,text:t.text})}},{key:"render",value:function(){return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"App",children:[Object(f.jsx)("h1",{children:"Chat App"}),Object(f.jsx)(y,{handleRoomSwitch:this.handleRoomSwitch}),Object(f.jsx)(S,{current_room:this.state.current_room,user:this.state.user,chat:this.state.chat,isEditMode:this.state.isEditMode,handleEdit:this.handleEdit,handleEditMode:this.handleEditMode,isLoggedIn:this.state.isLoggedIn,handleLogout:this.handleLogout})]})})}}]),n}(a.Component),L=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(e){var n=e.getCLS,a=e.getFID,s=e.getFCP,r=e.getLCP,o=e.getTTFB;n(t),a(t),s(t),r(t),o(t)}))};o.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(C,{})}),document.getElementById("root")),L()}},[[22,1,2]]]);
//# sourceMappingURL=main.09a16880.chunk.js.map